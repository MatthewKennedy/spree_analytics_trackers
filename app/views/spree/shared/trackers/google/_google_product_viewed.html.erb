<% if tracker = Spree::Tracker.current(:google_analytics) %>

    <script>
      gtag('event', 'view_item', {
        'send_to': 'analytics_tag',
        'content_type': 'product',
        'event_category': 'Enhanced Ecommerce',
        'event_label': 'Viewed <%= @product.name %>',
        'ecomm_prodid': '<%= @product.sku %>',
        'ecomm_pagetype': 'product',
        'ecomm_totalvalue': <%= @product.price.to_f %>,
        'ecomm_catagory': '<%= @taxon.try(:name) %>',
        'items': [
            {
            'id': '<%= @product.sku %>',
            'name': '<%= @product.name %>',
            'brand': '<%= @product.property('Brand') %>',
            'category': '<%= @taxon.try(:name) %>',
            'price': '<%= @product.price.to_f %>'
          }
        ]

      });
  </script>

<% end %>
