<% if tracker = Spree::Tracker.current(:segment) %>
  <script>
    if (typeof analytics !== 'undefined') {

      analytics.track('Cart Viewed', {
        ecomm_pagetype: 'cart',
        cart_id: '<%= @order.number %>',
        products: [
        <% @order.line_items.each_with_index do |line_item, index| %>
          <%= product_for_segment(line_item, position: index+1, quantity: line_item.quantity) %>,
        <% end %>
        ]
      });


    }
  </script>

  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('event', 'page_view', {'send_to': 'AW-992696821',
     'ecomm_pagetype': 'cart',
    });
  </script>
<% end %>
